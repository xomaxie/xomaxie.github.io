<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Eryndor — Dev Quick Reference (nav v2)</title>
<style>
:root{ --bg:#0f141a; --fg:#e6edf3; --muted:#9aa4af; --line:#293241; --primary:#64b5f6; --pri-2:#90caf9; --chip:#082032; --chip-fg:#90caf9; --card:#111827; --kbd-bg:#1f2937; }
*{ box-sizing:border-box } body{ margin:0; background:var(--bg); color:var(--fg); font: 15px/1.5 -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Arial,system-ui; }
header{ display:flex; align-items:center; gap:.75rem; padding:.75rem 1rem; border-bottom:1px solid var(--line); position:sticky; top:0; background:rgba(15,20,26,.9); backdrop-filter:saturate(1.2) blur(6px); z-index:50 }
.logo{ font-weight:700; letter-spacing:.4px; }
.logo small{ display:block; color:var(--muted); font-weight:500; letter-spacing:.2px; }
.container{ display:grid; grid-template-columns: 300px 1fr; min-height:calc(100vh - 56px) }
aside{ border-right:1px solid var(--line); padding:1rem; position:sticky; top:56px; height:calc(100vh - 56px); overflow:auto }
main{ padding:1rem 2rem; scroll-behavior:smooth; }
.search{ display:flex; gap:.5rem; margin-bottom:.5rem }
.search input{ flex:1; padding:.5rem .75rem; border:1px solid var(--line); border-radius:8px; background:var(--bg); color:var(--fg) }
.section h2{ color:var(--pri-2); border-bottom:1px solid var(--line); padding-bottom:.25rem }
.card{ background:var(--card); border:1px solid var(--line); border-radius:12px; padding:0; margin:1rem 0; overflow:hidden }
.card .card-hdr{ padding:.75rem 1rem; display:flex; align-items:baseline; gap:.75rem; border-bottom:1px solid var(--line) }
.card .meta{ padding:.5rem 1rem; display:flex; gap:1rem; flex-wrap:wrap; border-bottom:1px dashed var(--line) }
.tbl{ width:100%; border-collapse:collapse; } .tbl th,.tbl td{ border-top:1px solid var(--line); padding:.5rem .6rem; text-align:left; vertical-align:top; }
.badge{ display:inline-flex; align-items:center; gap:.25rem; padding:.15rem .45rem; background:var(--chip); color:var(--chip-fg); border-radius:999px; font-size:.75rem; border:1px solid var(--line) }
.err{ background:#5b1a1a; color:#ffdada; padding:.5rem 1rem; border-bottom:1px solid #7a2b2b; position:sticky; top:56px; z-index:60 }
.toc a{ display:block; padding:.25rem .25rem; border-radius:6px; color:var(--fg); text-decoration:none }
.toc a:hover{ background:#1c2530; }
.muted{ color:var(--muted) }
.kv{ display:flex; gap:.5rem; flex-wrap:wrap }
.kv div{ background:var(--kbd-bg); border:1px solid var(--line); padding:.15rem .5rem; border-radius:6px; font-size:.8rem }
hr.sep{ border:0; border-top:1px dashed var(--line); margin:.5rem 0 }
/* code blocks */
pre{ background:#0b1118; border:1px solid var(--line); border-radius:8px; padding:.75rem 1rem; overflow:auto; margin:.5rem 1rem .75rem 1rem }
code{ font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace; font-size:.95em }
.card .pad{ padding:.75rem 1rem }
</style>
</head>
<body>
<header>
  <div class="logo">
    FINAL BUILD GAMES
    <small>Eryndor — Dev Quick Reference</small>
  </div>
  <div class="muted">Snapshot: 2025-09-01</div>
</header>
<div id="err" class="err" style="display:none"></div>
<div class="container">
  <aside>
    <div class="search"><input id="q" type="search" placeholder="Search (press / to focus)" /></div>
    <div class="toc"><h3>Contents</h3><div id="toc"></div></div>
    <div class="muted" style="font-size:.85rem;margin-top:.5rem">Tip: Press <kbd>/</kbd> to jump to search.</div>
    <hr class="sep" />
    <div class="muted" style="font-size:.85rem">This page is static. DATA is embedded below.</div>
  </aside>
  <main>
    <div class="section" id="overview"><h2>Overview</h2></div>
    <div class="section" id="examples"><h2>Examples &amp; Usage</h2></div>
    <div class="section" id="singletons"><h2>Singletons (Autoload)</h2></div>
    <div class="section" id="ui"><h2>UI Scenes / Scripts</h2></div>
    <div class="section" id="other"><h2>Other Scripts</h2></div>
    <div class="section" id="scenes"><h2>Scenes</h2></div>
  </main>
</div>
<script>
"use strict";
(function(){
  const DATA = {"project": {"name": "Eryndor", "org": "Final Build Games", "snapshot": "2025-09-01", "main_scene": "uid://dwsa1vhklev6g"}, "singletons": [{"name": "Economy", "anchor": "Autoload_Economy", "path": "Autoload/Economy.gd", "class_name": "", "extends": "Node", "signals": [{"name": "purchase_made"}], "exports": [{"name": "wood_price", "type": ""}, {"name": "metal_price", "type": ""}], "public": [{"name": "balance", "args": "", "ret": "int"}, {"name": "get_unit_price", "args": "resource:String", "ret": "int"}, {"name": "estimate_buy_cost", "args": "resource:String, amount:int", "ret": "int"}, {"name": "can_afford", "args": "amount:int", "ret": "bool"}, {"name": "earn_gold", "args": "amount:int, reason:String = \"\"", "ret": "void"}, {"name": "spend_gold", "args": "amount:int, reason:String = \"\"", "ret": "bool"}, {"name": "buy", "args": "resource:String, amount:int", "ret": "bool"}, {"name": "weapon_craft_cost", "args": "", "ret": "Dictionary"}, {"name": "armor_craft_cost", "args": "", "ret": "Dictionary"}, {"name": "can_craft", "args": "cost:Dictionary", "ret": "bool"}, {"name": "try_consume_for_craft", "args": "cost:Dictionary, label:String", "ret": "bool"}], "internal": [], "role": "Other"}, {"name": "GameState", "anchor": "Autoload_GameState", "path": "Autoload/GameState.gd", "class_name": "", "extends": "Node", "signals": [{"name": "day_changed"}, {"name": "resources_changed"}, {"name": "transaction_logged"}, {"name": "recruit_hired"}, {"name": "roster_updated"}], "exports": [{"name": "start_gold", "type": ""}, {"name": "start_wood", "type": ""}, {"name": "start_metal", "type": ""}, {"name": "cap_gold", "type": ""}, {"name": "cap_wood", "type": ""}, {"name": "cap_metal", "type": ""}, {"name": "shop_slots", "type": ""}, {"name": "shop_level_min", "type": ""}, {"name": "shop_level_max", "type": ""}, {"name": "shop_guarantee_roles", "type": ""}, {"name": "debug_print", "type": ""}], "public": [{"name": "snapshot", "args": "", "ret": "Dictionary"}, {"name": "load_from", "args": "data:Dictionary", "ret": "void"}, {"name": "next_day", "args": "", "ret": "void"}, {"name": "set_caps", "args": "new_cap_gold:int, new_cap_wood:int, new_cap_metal:int", "ret": "void"}, {"name": "get_gold", "args": "", "ret": "int"}, {"name": "get_wood", "args": "", "ret": "int"}, {"name": "get_metal", "args": "", "ret": "int"}, {"name": "add_gold", "args": "amount:int, reason:String = \"\"", "ret": "void"}, {"name": "add_wood", "args": "amount:int, reason:String = \"\"", "ret": "void"}, {"name": "add_metal", "args": "amount:int, reason:String = \"\"", "ret": "void"}, {"name": "add_resources", "args": "delta:Dictionary, reason:String = \"\"", "ret": "void"}, {"name": "has_materials", "args": "req:Dictionary", "ret": "bool"}, {"name": "consume_materials", "args": "req:Dictionary", "ret": "bool"}, {"name": "current_recruits", "args": "", "ret": "Array"}, {"name": "can_afford", "args": "price:int", "ret": "bool"}, {"name": "try_hire_recruit", "args": "index:int", "ret": "Recruit"}], "internal": [{"name": "_ready", "args": "", "ret": "void"}, {"name": "_initialize_resources", "args": "", "ret": "void"}, {"name": "_clamp_to_caps", "args": "emit_after:bool", "ret": "void"}, {"name": "_emit_resources", "args": "", "ret": "void"}, {"name": "_log_tx", "args": "kind:String, delta:int, before:int, after:int, reason:String", "ret": "void"}, {"name": "_try_connect_recruit_roster", "args": "", "ret": "void"}, {"name": "_init_or_refresh_roster_for_day", "args": "", "ret": "void"}, {"name": "_on_roster_refreshed", "args": "d:int, count:int", "ret": "void"}, {"name": "_on_roster_hired", "args": "_i:int, r:Recruit", "ret": "void"}], "role": "Other"}, {"name": "RecruitRoster", "anchor": "Autoload_RecruitRoster", "path": "Autoload/RecruitRoster.gd", "class_name": "", "extends": "Node", "signals": [{"name": "roster_refreshed"}, {"name": "recruit_hired"}], "exports": [{"name": "slots", "type": ""}, {"name": "level_min", "type": ""}, {"name": "level_max", "type": ""}, {"name": "guarantee_roles", "type": ""}, {"name": "debug_print", "type": ""}, {"name": "persist_hires_to_guild", "type": ""}], "public": [{"name": "init_day", "args": "day: int,\n\tslots_override: int = -1,\n\tlevel_min_override: int = -1,\n\tlevel_max_override: int = -1,\n\tguarantee_roles_override: bool = true", "ret": "void"}, {"name": "set_day", "args": "day: int", "ret": "void"}, {"name": "next_day", "args": "", "ret": "void"}, {"name": "list", "args": "", "ret": "Array"}, {"name": "size", "args": "", "ret": "int"}, {"name": "get_at", "args": "idx: int", "ret": "Recruit"}, {"name": "hire", "args": "idx: int", "ret": "Recruit"}, {"name": "reseed", "args": "seed_value: int", "ret": "void"}, {"name": "reroll", "args": "", "ret": "void"}, {"name": "use_day_seed", "args": "", "ret": "void"}], "internal": [{"name": "_ready", "args": "", "ret": "void"}, {"name": "_refresh_for_day_internal", "args": "", "ret": "void"}, {"name": "_effective_seed", "args": "", "ret": "int"}, {"name": "_seed_for_day", "args": "day: int", "ret": "int"}, {"name": "_mix32", "args": "a: int, b: int", "ret": "int"}, {"name": "_print_debug", "args": "", "ret": "void"}, {"name": "_ensure_generator", "args": "", "ret": "void"}, {"name": "_store_in_guild", "args": "r: Recruit", "ret": "void"}], "role": "UI"}, {"name": "GuildMembers", "anchor": "Autoload_GuildMembers", "path": "Autoload/GuildMembers.gd", "class_name": "", "extends": "Node", "signals": [{"name": "members_changed"}, {"name": "member_damaged"}, {"name": "member_xp_changed"}], "exports": [{"name": "auto_kill_on_zero", "type": ""}], "public": [{"name": "add", "args": "recruit: Recruit", "ret": "void"}, {"name": "remove", "args": "recruit: Recruit", "ret": "void"}, {"name": "clear", "args": "", "ret": "void"}, {"name": "list", "args": "", "ret": "Array"}, {"name": "size", "args": "", "ret": "int"}, {"name": "fire", "args": "idx: int", "ret": "void"}, {"name": "kill", "args": "idx: int", "ret": "void"}, {"name": "damage", "args": "idx: int, amount: int", "ret": "int"}, {"name": "heal", "args": "idx: int, amount: int", "ret": "int"}, {"name": "heal_full", "args": "idx: int", "ret": "int"}, {"name": "add_xp", "args": "idx: int, amount: int", "ret": "int"}, {"name": "level_up", "args": "idx: int", "ret": "void"}], "internal": [], "role": "UI"}, {"name": "MusicManager", "anchor": "Autoload_MusicManager", "path": "Autoload/MusicManager.gd", "class_name": "", "extends": "Node", "signals": [], "exports": [{"name": "title_path", "type": ""}, {"name": "game_tracks_dir", "type": ""}, {"name": "track_min_index", "type": ""}, {"name": "track_max_index", "type": ""}, {"name": "music_bus", "type": ""}, {"name": "default_fade", "type": ""}, {"name": "duck_db", "type": ""}, {"name": "duck_fade_sec", "type": ""}, {"name": "unduck_fade_sec", "type": ""}, {"name": "advance_fade_sec", "type": ""}, {"name": "avoid_repeat", "type": ""}, {"name": "persist_min_db", "type": ""}, {"name": "persist_max_db", "type": ""}], "public": [{"name": "preload_all", "args": "", "ret": "void"}, {"name": "is_playing_title", "args": "", "ret": "bool"}, {"name": "play_title", "args": "fade: float = default_fade", "ret": "void"}, {"name": "play_run_start", "args": "fade: float = default_fade", "ret": "void"}, {"name": "play_random_game_track", "args": "fade: float = default_fade", "ret": "void"}, {"name": "next_game_track", "args": "fade: float = default_fade", "ret": "void"}, {"name": "stop_music", "args": "fade: float = default_fade", "ret": "void"}, {"name": "set_bus", "args": "name: String", "ret": "void"}, {"name": "set_volume_db", "args": "db: float, tween_sec: float = 0.15", "ret": "void"}, {"name": "set_volume_unit", "args": "unit_0_1: float, tween_sec: float = 0.15", "ret": "void"}, {"name": "get_volume_unit", "args": "", "ret": "float"}, {"name": "duck_music", "args": "dur: float = -1.0", "ret": "void"}, {"name": "unduck_music", "args": "dur: float = -1.0", "ret": "void"}, {"name": "set_auto_advance", "args": "enabled: bool", "ret": "void"}, {"name": "load_saved_volume", "args": "", "ret": "void"}, {"name": "save_volume", "args": "unit_0_1: float", "ret": "void"}], "internal": [{"name": "_ready", "args": "", "ret": "void"}, {"name": "_play_slot", "args": "slot: int, fade: float", "ret": "void"}, {"name": "_play_stream", "args": "s: AudioStream", "ret": "void"}, {"name": "_load_title_stream", "args": "", "ret": "void"}, {"name": "_build_track_list", "args": "", "ret": "void"}, {"name": "_warm_up_streams", "args": "", "ret": "void"}, {"name": "_on_any_finished", "args": "", "ret": "void"}, {"name": "_pick_slot", "args": "", "ret": "int"}, {"name": "_current_player", "args": "", "ret": "AudioStreamPlayer"}, {"name": "_next_player", "args": "", "ret": "AudioStreamPlayer"}, {"name": "_effective_db", "args": "", "ret": "float"}, {"name": "_apply_volume", "args": "db: float, tween_sec: float", "ret": "void"}], "role": "Other"}], "ui": [{"name": "credits", "anchor": "credits", "path": "Scenes/Main Menu/credits.gd", "class_name": "", "extends": "Control", "signals": [], "exports": [], "public": [], "internal": [{"name": "_on_go_back_mouse_entered", "args": "", "ret": "void"}, {"name": "_on_go_back_pressed", "args": "", "ret": "void"}, {"name": "_on_go_back_focus_entered", "args": "", "ret": "void"}], "role": "UI"}, {"name": "main_menu", "anchor": "main_menu", "path": "Scenes/Main Menu/main_menu.gd", "class_name": "", "extends": "Control", "signals": [], "exports": [], "public": [], "internal": [{"name": "_ready", "args": "", "ret": "void"}, {"name": "_on_continue_mouse_entered", "args": "", "ret": "void"}, {"name": "_on_new_game_mouse_entered", "args": "", "ret": "void"}, {"name": "_on_settings_mouse_entered", "args": "", "ret": "void"}, {"name": "_on_credits_mouse_entered", "args": "", "ret": "void"}, {"name": "_on_quit_mouse_entered", "args": "", "ret": "void"}, {"name": "_on_continue_pressed", "args": "", "ret": "void"}, {"name": "_on_new_game_pressed", "args": "", "ret": "void"}, {"name": "_on_settings_pressed", "args": "", "ret": "void"}, {"name": "_on_credits_pressed", "args": "", "ret": "void"}, {"name": "_on_quit_pressed", "args": "", "ret": "void"}, {"name": "_on_continue_focus_entered", "args": "", "ret": "void"}, {"name": "_on_new_game_focus_entered", "args": "", "ret": "void"}, {"name": "_on_settings_focus_entered", "args": "", "ret": "void"}, {"name": "_on_credits_focus_entered", "args": "", "ret": "void"}, {"name": "_on_quit_focus_entered", "args": "", "ret": "void"}], "role": "UI"}, {"name": "SettingsUI", "anchor": "SettingsUI", "path": "Scenes/Main Menu/settings.gd", "class_name": "SettingsUI", "extends": "Control", "signals": [], "exports": [{"name": "bus_fallback", "type": ""}, {"name": "min_db", "type": ""}, {"name": "max_db", "type": ""}], "public": [], "internal": [{"name": "_ready", "args": "", "ret": "void"}, {"name": "_bind_nodes", "args": "", "ret": "void"}, {"name": "_init_slider", "args": "", "ret": "void"}, {"name": "_update_label", "args": "", "ret": "void"}, {"name": "_on_slider_value_changed", "args": "v: float", "ret": "void"}, {"name": "_init_bus_index", "args": "", "ret": "void"}, {"name": "_apply_music_volume", "args": "unit_0_1: float", "ret": "void"}, {"name": "_sync_from_manager_silent", "args": "", "ret": "void"}, {"name": "_unit_to_db", "args": "u: float", "ret": "float"}, {"name": "_db_to_unit", "args": "db: float", "ret": "float"}, {"name": "_on_go_back_pressed", "args": "", "ret": "void"}], "role": "UI"}, {"name": "UI_EconomyTest", "anchor": "UI_EconomyTest", "path": "User Interface/economy_test.gd", "class_name": "UI_EconomyTest", "extends": "Control", "signals": [], "exports": [], "public": [], "internal": [{"name": "_ready", "args": "", "ret": "void"}, {"name": "_init_roster", "args": "", "ret": "void"}, {"name": "_on_res_changed", "args": "s: Dictionary", "ret": "void"}, {"name": "_on_day_changed", "args": "d: int", "ret": "void"}, {"name": "_on_tx", "args": "entry: Dictionary", "ret": "void"}, {"name": "_on_purchase", "args": "kind: String, units: int, cost: int", "ret": "void"}, {"name": "_on_earn10", "args": "", "ret": "void"}, {"name": "_on_earn100", "args": "", "ret": "void"}, {"name": "_on_reset_gold", "args": "", "ret": "void"}, {"name": "_on_spend50", "args": "", "ret": "void"}, {"name": "_on_buy_wood", "args": "", "ret": "void"}, {"name": "_on_buy_metal", "args": "", "ret": "void"}, {"name": "_on_craft_weapon", "args": "", "ret": "void"}, {"name": "_on_craft_armor", "args": "", "ret": "void"}, {"name": "_on_next_day", "args": "", "ret": "void"}, {"name": "_on_refresh_roster", "args": "", "ret": "void"}, {"name": "_on_reroll_seed", "args": "", "ret": "void"}, {"name": "_on_toggle_guarantee", "args": "", "ret": "void"}, {"name": "_on_apply_seed", "args": "", "ret": "void"}, {"name": "_on_slots_delta", "args": "d: int", "ret": "void"}, {"name": "_on_lvmin_delta", "args": "d: int", "ret": "void"}, {"name": "_on_lvmax_delta", "args": "d: int", "ret": "void"}, {"name": "_on_hire_index", "args": "idx: int", "ret": "void"}, {"name": "_on_hire_cheapest", "args": "", "ret": "void"}, {"name": "_on_hire_all", "args": "", "ret": "void"}, {"name": "_on_preview_role", "args": "role: int", "ret": "void"}, {"name": "_refresh_prices", "args": "", "ret": "void"}, {"name": "_cost_text", "args": "cost: Dictionary", "ret": "String"}, {"name": "_ensure_log_node", "args": "", "ret": "void"}, {"name": "_force_log_overlay", "args": "", "ret": "void"}, {"name": "_log_diag_ping", "args": "", "ret": "void"}, {"name": "_append_log", "args": "line: String", "ret": "void"}, {"name": "_update_roster_info", "args": "", "ret": "void"}, {"name": "_update_guarantee_text", "args": "", "ret": "void"}, {"name": "_list_roster", "args": "", "ret": "void"}, {"name": "_on_clear_log", "args": "", "ret": "void"}, {"name": "_stretch_log_full_height", "args": "", "ret": "void"}, {"name": "_on_open_guild", "args": "", "ret": "void"}, {"name": "_on_gw_refresh", "args": "", "ret": "void"}, {"name": "_on_gw_close", "args": "", "ret": "void"}, {"name": "_refresh_guild_window", "args": "", "ret": "void"}, {"name": "_clear_guild_rows", "args": "", "ret": "void"}, {"name": "_add_info_row", "args": "text: String", "ret": "void"}, {"name": "_add_member_row", "args": "idx: int, r: Recruit", "ret": "void"}, {"name": "_on_fire_member", "args": "idx: int", "ret": "void"}, {"name": "_on_kill_member", "args": "idx: int", "ret": "void"}, {"name": "_on_damage_member", "args": "idx: int, amount: int", "ret": "void"}, {"name": "_on_heal_member", "args": "idx: int, amount: int", "ret": "void"}, {"name": "_on_heal_full_member", "args": "idx: int", "ret": "void"}, {"name": "_guild_member_bbcode", "args": "idx: int, r: Recruit", "ret": "String"}, {"name": "_role_name", "args": "role: int", "ret": "String"}, {"name": "_member_details_text", "args": "r: Recruit", "ret": "String"}, {"name": "_on_add_xp_member", "args": "idx: int, amount: int", "ret": "void"}, {"name": "_on_level_up_member", "args": "idx: int", "ret": "void"}], "role": "UI"}, {"name": "RecruitDB", "anchor": "RecruitDB", "path": "Autoload/RecruitDB.gd", "class_name": "RecruitDB", "extends": "Node", "signals": [], "exports": [], "public": [{"name": "all_recruits", "args": "", "ret": "Array"}, {"name": "random_recruit_by_role", "args": "role: int", "ret": "Recruit"}], "internal": [{"name": "_ready", "args": "", "ret": "void"}, {"name": "_seed_minimal_roster", "args": "", "ret": "void"}, {"name": "_make_recruit", "args": "name: String,\n\trole: int,\n\tstr_: int,\n\tdex: int,\n\tcon: int,\n\twis: int,\n\tcha: int,\n\tint_: int,\n\tlevel: int", "ret": "Recruit"}], "role": "UI"}, {"name": "RecruitRoster", "anchor": "RecruitRoster", "path": "Autoload/RecruitRoster.gd", "class_name": "", "extends": "Node", "signals": [{"name": "roster_refreshed"}, {"name": "recruit_hired"}], "exports": [{"name": "slots", "type": ""}, {"name": "level_min", "type": ""}, {"name": "level_max", "type": ""}, {"name": "guarantee_roles", "type": ""}, {"name": "debug_print", "type": ""}, {"name": "persist_hires_to_guild", "type": ""}], "public": [{"name": "init_day", "args": "day: int,\n\tslots_override: int = -1,\n\tlevel_min_override: int = -1,\n\tlevel_max_override: int = -1,\n\tguarantee_roles_override: bool = true", "ret": "void"}, {"name": "set_day", "args": "day: int", "ret": "void"}, {"name": "next_day", "args": "", "ret": "void"}, {"name": "list", "args": "", "ret": "Array"}, {"name": "size", "args": "", "ret": "int"}, {"name": "get_at", "args": "idx: int", "ret": "Recruit"}, {"name": "hire", "args": "idx: int", "ret": "Recruit"}, {"name": "reseed", "args": "seed_value: int", "ret": "void"}, {"name": "reroll", "args": "", "ret": "void"}, {"name": "use_day_seed", "args": "", "ret": "void"}], "internal": [{"name": "_ready", "args": "", "ret": "void"}, {"name": "_refresh_for_day_internal", "args": "", "ret": "void"}, {"name": "_effective_seed", "args": "", "ret": "int"}, {"name": "_seed_for_day", "args": "day: int", "ret": "int"}, {"name": "_mix32", "args": "a: int, b: int", "ret": "int"}, {"name": "_print_debug", "args": "", "ret": "void"}, {"name": "_ensure_generator", "args": "", "ret": "void"}, {"name": "_store_in_guild", "args": "r: Recruit", "ret": "void"}], "role": "UI"}], "scenes": [{"scene_path": "Scenes/game.tscn", "root_name": "Game", "root_type": "Node2D", "node_count": 1, "scripts": []}, {"scene_path": "Scenes/RosterTest.tscn", "root_name": "RosterTest", "root_type": "Control", "node_count": 1, "scripts": []}, {"scene_path": "Scenes/TestEconomy.tscn", "root_name": "EconomyTest", "root_type": "Control", "node_count": 85, "scripts": []}, {"scene_path": "Scenes/Main Menu/Credits.tscn", "root_name": "Credits", "root_type": "Control", "node_count": 11, "scripts": []}, {"scene_path": "Scenes/Main Menu/MainMenu.tscn", "root_name": "MainMenu", "root_type": "Control", "node_count": 12, "scripts": []}, {"scene_path": "Scenes/Main Menu/Settings.tscn", "root_name": "Settings", "root_type": "Control", "node_count": 12, "scripts": []}], "how": ["- The game boots into <code>uid://dwsa1vhklev6g<\/code>.", "- Autoloads initialize early to provide shared state and APIs across scenes.", "- UI scenes subscribe to signals and update on state changes."]};

  /* DOM helpers */
  const $ = (s,root=document)=>root.querySelector(s);
  const $$ = (s,root=document)=>Array.from(root.querySelectorAll(s));
  function makeTable(h){ const tbl=document.createElement('table'); tbl.className='tbl'; const thead=document.createElement('thead'); const tr=document.createElement('tr'); h.forEach(x=>{const th=document.createElement('th'); th.textContent=x; tr.appendChild(th);}); thead.appendChild(tr); tbl.appendChild(thead); const tbody=document.createElement('tbody'); tbl.appendChild(tbody); return [tbl,tbody]; }
  function addTOC(id,text){ const a=document.createElement('a'); a.href='#'+id; a.textContent=text; document.getElementById('toc').appendChild(a); }
  function codeBlock(txt){ const pre=document.createElement('pre'); const c=document.createElement('code'); c.textContent=txt; pre.appendChild(c); return pre; }

  /* Script cards */
  function renderScriptCard(target,s,icon,label){
    const card=document.createElement('div'); card.className='card'; card.id=s.anchor||s.name;
    const hdr=document.createElement('div'); hdr.className='card-hdr'; hdr.innerHTML=`<h3>${icon} ${s.name}</h3> <span class="muted">${s.path||''}</span>`; card.appendChild(hdr);
    const meta=document.createElement('div'); meta.className='meta'; const bits=[];
    if(s.class_name) bits.push(`<div><strong>class_name</strong>: <code>${s.class_name}</code></div>`);
    if(s.extends) bits.push(`<div><strong>extends</strong>: <code>${s.extends}</code></div>`);
    if(s.signals&&s.signals.length) bits.push(`<div><strong>signals</strong>: <code>${s.signals.map(x=>x.name).join(', ')}</code></div>`);
    if(s.exports&&s.exports.length) bits.push(`<div><strong>exports</strong>: <code>${s.exports.map(x=>x.name).join(', ')}</code></div>`);
    meta.innerHTML=bits.join(''); card.appendChild(meta);
    if(s.public&&s.public.length){
      const [tbl,body]=makeTable(['Public Method','Signature']);
      s.public.forEach(f=>{ const sig = `${f.ret||'void'} ${f.name}(${f.args||''})`; const tr=document.createElement('tr'); tr.innerHTML=`<td><code>${f.name}</code></td><td><code>${sig}</code></td>`; body.appendChild(tr); });
      card.appendChild(tbl);
    }
    if(s.internal&&s.internal.length){
      const [tbl,body]=makeTable(['Internal Method','Signature']);
      s.internal.forEach(f=>{ const sig = `${f.ret||'void'} ${f.name}(${f.args||''})`; const tr=document.createElement('tr'); tr.innerHTML=`<td><code>${f.name}</code></td><td><code>${sig}</code></td>`; body.appendChild(tr); });
      card.appendChild(tbl);
    }
    target.appendChild(card); addTOC(card.id, `${label}: ${s.name}`);
  }

  /* Search */
  const q=document.getElementById('q');
  document.addEventListener('keydown',e=>{ if(e.key==='/'){ e.preventDefault(); q&&q.focus(); } });
  if(q) q.addEventListener('input',()=>{
    const t=q.value.toLowerCase();
    $$('.card').forEach(c=>{ c.style.display = c.textContent.toLowerCase().includes(t)?'':''; });
    Array.from(document.getElementById('toc').children).forEach(a=>{
      const tgt=document.querySelector(a.getAttribute('href'));
      a.style.display = (!t || (tgt && tgt.style.display!=='none' && a.textContent.toLowerCase().includes(t))) ? '' : 'none';
    });
  });

  /* Overview */
  const ov=document.getElementById('overview');
  const ovCard=document.createElement('div'); ovCard.className='card';
  ovCard.innerHTML=`<div class="card-hdr"><h3>Project</h3><span class="muted">${DATA.project.name}</span></div>`;
  const ovMeta=document.createElement('div'); ovMeta.className='meta';
  ovMeta.innerHTML = `<div><strong>Main Scene</strong>: <code>${DATA.project.main_scene||'—'}</code></div>`;
  ovCard.appendChild(ovMeta);
  const ovBody=document.createElement('div'); ovBody.className='pad';
  ovBody.innerHTML = `
    <p>This static quick reference renders your Autoload singletons, UI scripts, and scenes from the embedded <code>DATA</code> object. Use the search box (<kbd>/</kbd>) and the TOC to jump around. Each card lists signatures to call directly from GDScript.</p>
    <p><strong>How to use:</strong> open this HTML file locally or host it with your repo. When your APIs change, update the <code>DATA</code> JSON below and refresh.</p>
  `;
  ovCard.appendChild(ovBody);
  if(DATA.how&&DATA.how.length){ const [tbl,body]=makeTable(['How it works']); DATA.how.forEach(line=>{ const tr=document.createElement('tr'); tr.innerHTML = `<td>${line}</td>`; body.appendChild(tr); }); ovCard.appendChild(tbl); }
  ov.appendChild(ovCard); addTOC('overview','Overview');

  /* Examples & Usage */
  const exSec=document.getElementById('examples');
  function makeExampleCard(title, desc, code){
    const card=document.createElement('div'); card.className='card'; card.id='ex_'+title.toLowerCase().replace(/[^a-z0-9]+/g,'_');
    card.innerHTML=`<div class="card-hdr"><h3>${title}</h3></div>`;
    const body=document.createElement('div'); body.className='pad';
    const p=document.createElement('p'); p.textContent=desc; body.appendChild(p);
    body.appendChild(codeBlock(code));
    card.appendChild(body); exSec.appendChild(card);
    addTOC(card.id, `Examples: ${title}`);
  }

  makeExampleCard(
    'Economy (autoload)',
    'Gold/price helpers and resource purchases. Available globally as “Economy”.',
`Economy.earn_gold(25, "quest")
var price: int = Economy.get_unit_price("wood")
var cost: int = Economy.estimate_buy_cost("wood", 3)
if Economy.can_afford(cost):
    Economy.buy("wood", 3)`
  );

  makeExampleCard(
    'GameState (autoload)',
    'Holds current resources, day, and shop config. Emits resource/day signals.',
`GameState.add_resources({"wood": 10, "metal": 2}, "reward")
if GameState.can_afford(50):
    GameState.add_gold(-50, "fee")
GameState.next_day()`
  );

  makeExampleCard(
    'RecruitRoster (autoload)',
    'Daily shop/roster of recruits; seedable and hireable.',
`RecruitRoster.init_day(1, -1, 1, 3, true)
for r in RecruitRoster.list():
    print(r.summary())
var hired: Recruit = RecruitRoster.hire(0)
if hired:
    GuildMembers.add(hired)`
  );

  makeExampleCard(
    'GuildMembers (autoload)',
    'Hired party container with HP and XP utilities.',
`GuildMembers.members_changed.connect(func() -> void:
    print("Members:", GuildMembers.size())
)
if GuildMembers.size() > 0:
    GuildMembers.damage(0, 5)`
  );

  makeExampleCard(
    'MusicManager (autoload)',
    'Title/game music control, ducking, and volume persistence.',
`MusicManager.play_title()
MusicManager.set_volume_unit(0.6)
await get_tree().create_timer(2.0).timeout
MusicManager.play_random_game_track()`
  );

  makeExampleCard(
    'SettingsUI (scene script)',
    'Drop into Settings.tscn. Exposes a music volume slider bound to MusicManager.',
`var ui: SettingsUI = preload("res://Scenes/Main Menu/settings.gd").new()
add_child(ui)
// Ensure nodes named "MusicSlider" and "Label" or assign exported paths in the inspector.`
  );

  /* Cards for data */
  const secSingletons=document.getElementById('singletons');
  DATA.singletons.forEach(s=>renderScriptCard(secSingletons, s, '⚙️', 'Singleton'));

  const secUI=document.getElementById('ui');
  DATA.ui.forEach(s=>renderScriptCard(secUI, s, '🗂️', 'UI'));

  const secOther=document.getElementById('other');
  if (DATA.other && DATA.other.length) {
    DATA.other.forEach(s=>renderScriptCard(secOther, s, '📄', 'Script'));
  }

  const secScenes=document.getElementById('scenes');
  const sceneCard=document.createElement('div'); sceneCard.className='card'; sceneCard.id='scenes_table';
  sceneCard.innerHTML=`<div class="card-hdr"><h3>Scenes</h3><span class="muted">${DATA.scenes.length} found</span></div>`;
  const [tbl,body]=makeTable(['Scene Path','Root','Root Type','Nodes','Scripts']);
  DATA.scenes.forEach(sc=>{
    const tr=document.createElement('tr');
    tr.innerHTML = `<td><code>${sc.scene_path}</code></td><td>${sc.root_name||'—'}</td><td>${sc.root_type||'—'}</td><td>${sc.node_count||0}</td><td>${(sc.scripts||[]).map(p=>`<code>${p}</code>`).join('<br/>')||'—'}</td>`;
    body.appendChild(tr);
  });
  sceneCard.appendChild(tbl); secScenes.appendChild(sceneCard); addTOC('scenes_table','Scenes');
})();
</script>
</body>
</html>
